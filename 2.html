<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduComic Generator | C√≥mics Educativos en Cuadr√≠cula</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Orbitron:wght@400;600;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --matematica: #3a86ff;
            --lenguaje: #2a9d8f;
            --ciencias: #e63946;
            --sociales: #9b5de5;
            --accent: #f4a261;
            --dark: #0a0a1a;
            --light: #f8fafc;
            --gray: #8892b0;
            --gray-light: #1e293b;
            --border-radius: 12px;
            --shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            --shadow-hover: 0 0 30px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            color: var(--light);
            background: linear-gradient(135deg, #0a0a1a 0%, #15152b 50%, #1a1a35 100%);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(58, 134, 255, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(155, 93, 229, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(230, 57, 70, 0.05) 0%, transparent 50%);
            z-index: -1;
            pointer-events: none;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            line-height: 1.3;
            letter-spacing: 0.5px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        /* Header */
        header {
            background: linear-gradient(135deg, rgba(10, 10, 26, 0.9) 0%, rgba(21, 21, 43, 0.9) 100%);
            color: white;
            padding: 24px 0;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid rgba(58, 134, 255, 0.2);
            box-shadow: 0 0 30px rgba(58, 134, 255, 0.05);
            backdrop-filter: blur(10px);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--accent), #e76f51);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 15px rgba(244, 162, 97, 0.5);
        }
        
        .logo-text h1 {
            font-size: 1.8rem;
            margin-bottom: 4px;
            background: linear-gradient(90deg, #fff, var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .logo-text p {
            font-size: 0.95rem;
            opacity: 0.9;
            color: #a0aec0;
        }
        
        /* Materias Grid */
        .materias-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
            margin: 40px 0;
        }
        
        .materia-card {
            background: rgba(15, 15, 35, 0.8);
            border-radius: var(--border-radius);
            padding: 28px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
            min-height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .materia-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, currentColor 0%, transparent 100%);
            opacity: 0.1;
            z-index: 0;
        }
        
        .materia-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
        }
        
        .materia-card.active {
            border-color: currentColor;
            box-shadow: 0 0 15px currentColor;
        }
        
        .materia-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        
        .materia-card h3 {
            font-size: 1.4rem;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            text-align: center;
            width: 100%;
        }
        
        .materia-card p {
            color: var(--gray);
            font-size: 0.95rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
            text-align: center;
            width: 100%;
            line-height: 1.5;
        }
        
        .materia-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: currentColor;
            color: var(--dark);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 0 8px currentColor;
            z-index: 1;
            max-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* Colores espec√≠ficos de materias */
        .matematica-card {
            color: var(--matematica);
        }
        
        .lenguaje-card {
            color: var(--lenguaje);
        }
        
        .ciencias-card {
            color: var(--ciencias);
        }
        
        .sociales-card {
            color: var(--sociales);
        }
        
        /* Main Controls */
        .main-controls {
            background: rgba(15, 15, 35, 0.8);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 32px;
            margin: 40px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }
        
        .control-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .control-title {
            flex: 1;
            min-width: 300px;
        }
        
        .control-title h2 {
            font-size: 1.6rem;
            color: var(--light);
            background: linear-gradient(90deg, #fff, var(--matematica));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .control-title p {
            color: var(--gray);
            margin-top: 8px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .btn-generate {
            background: linear-gradient(135deg, var(--matematica), var(--sociales));
            color: var(--dark);
            border: none;
            padding: 18px 40px;
            font-size: 1.1rem;
            font-weight: 800;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            box-shadow: 0 0 15px rgba(58, 134, 255, 0.3);
            letter-spacing: 1px;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
            font-family: 'Orbitron', sans-serif;
            white-space: nowrap;
        }
        
        .btn-generate:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 20px rgba(58, 134, 255, 0.5);
        }
        
        .btn-generate:active {
            transform: translateY(0);
        }
        
        .control-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
        }
        
        .option-group {
            background: rgba(25, 25, 50, 0.6);
            border-radius: var(--border-radius);
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
            backdrop-filter: blur(5px);
            overflow: hidden;
        }
        
        .option-group:hover {
            border-color: currentColor;
            box-shadow: 0 0 10px currentColor;
        }
        
        .option-title {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .option-title i {
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        .option-title h3 {
            font-size: 1.2rem;
            color: var(--light);
            flex: 1;
            min-width: 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .slider-container {
            margin-top: 16px;
            width: 100%;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: var(--gray);
            flex-wrap: wrap;
        }
        
        .slider-label span:last-child {
            font-weight: 600;
            color: var(--light);
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
            -webkit-appearance: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 8px currentColor;
            border: 2px solid var(--dark);
        }
        
        /* Estilos din√°micos para colores de materias en controles */
        .matematica-controls .slider::-webkit-slider-thumb,
        .matematica-controls .option-title i {
            background: var(--matematica);
            color: var(--matematica);
        }
        
        .lenguaje-controls .slider::-webkit-slider-thumb,
        .lenguaje-controls .option-title i {
            background: var(--lenguaje);
            color: var(--lenguaje);
        }
        
        .ciencias-controls .slider::-webkit-slider-thumb,
        .ciencias-controls .option-title i {
            background: var(--ciencias);
            color: var(--ciencias);
        }
        
        .sociales-controls .slider::-webkit-slider-thumb,
        .sociales-controls .option-title i {
            background: var(--sociales);
            color: var(--sociales);
        }
        
        /* Nivel educativo */
        .nivel-options {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .nivel-option {
            flex: 1;
            min-width: 100px;
            padding: 14px 10px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            background: rgba(255, 255, 255, 0.05);
            color: var(--gray);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
            overflow: hidden;
            word-wrap: break-word;
        }
        
        .nivel-option:hover {
            border-color: currentColor;
            color: currentColor;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .nivel-option.active {
            border-color: currentColor;
            background: rgba(255, 255, 255, 0.1);
            color: currentColor;
            box-shadow: 0 0 8px currentColor;
        }
        
        /* Comic Display */
        .comic-display-container {
            background: rgba(15, 15, 35, 0.8);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 40px;
            margin-bottom: 40px;
            min-height: 600px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .comic-loading {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(10, 10, 26, 0.95);
            z-index: 10;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 24px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .comic-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .comic-title {
            font-size: 2rem;
            color: var(--light);
            position: relative;
            line-height: 1.2;
            margin-bottom: 8px;
            background: linear-gradient(90deg, #fff, var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-width: 100%;
        }
        
        .comic-subtitle {
            color: var(--gray);
            font-size: 1.1rem;
            max-width: 600px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .comic-meta {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
        }
        
        .meta-item {
            text-align: center;
            min-width: 80px;
        }
        
        .meta-value {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--light);
        }
        
        .meta-label {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        /* Comic Panels en cuadr√≠cula 2x2 */
        .comic-grid-container {
            margin-top: 32px;
            width: 100%;
            overflow: hidden;
        }
        
        .comic-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, auto);
            gap: 25px;
            margin-bottom: 30px;
            width: 100%;
        }
        
        .comic-panel {
            background: rgba(25, 25, 50, 0.6);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border: 2px solid;
            transition: var(--transition);
            position: relative;
            min-height: 320px;
            display: flex;
            flex-direction: column;
            height: 100%;
            backdrop-filter: blur(5px);
            width: 100%;
        }
        
        .comic-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
        }
        
        .panel-header {
            color: var(--dark);
            padding: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 800;
            min-height: 70px;
            flex-shrink: 0;
        }
        
        .panel-number {
            font-weight: 800;
            font-size: 1.1rem;
            font-family: 'Orbitron', sans-serif;
            flex-shrink: 0;
            margin-right: 10px;
        }
        
        .panel-topic {
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.9);
            padding: 6px 12px;
            border-radius: 20px;
            max-width: 60%;
            text-align: center;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-weight: 600;
            flex-shrink: 1;
        }
        
        /* Panel content optimizado para cuadr√≠cula */
        .panel-content {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow: hidden;
            min-height: 0;
        }
        
        /* Di√°logo optimizado */
        .dialogue-container {
            margin-bottom: 15px;
            flex-shrink: 0;
        }
        
        .dialogue-box {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid;
            border-radius: 10px;
            padding: 18px;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .dialogue-box:after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 25px;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid;
        }
        
        .dialogue-text {
            font-size: 1.05rem;
            line-height: 1.5;
            color: var(--dark);
            font-weight: 500;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-height: 120px;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .dialogue-text::-webkit-scrollbar {
            width: 4px;
        }
        
        .dialogue-text::-webkit-scrollbar-thumb {
            background: currentColor;
            border-radius: 2px;
        }
        
        /* Personaje optimizado */
        .character-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: auto;
            flex-shrink: 0;
            min-height: 90px;
        }
        
        .character-avatar {
            width: 70px;
            height: 70px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem;
            border: 3px solid;
            flex-shrink: 0;
            backdrop-filter: blur(5px);
        }
        
        .character-info {
            flex-grow: 1;
            min-width: 0;
            overflow: hidden;
        }
        
        .character-name {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 4px;
            color: var(--light);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .character-role {
            font-size: 0.85rem;
            color: var(--gray);
            line-height: 1.3;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-height: 40px;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .character-role::-webkit-scrollbar {
            width: 3px;
        }
        
        .character-role::-webkit-scrollbar-thumb {
            background: currentColor;
            border-radius: 2px;
        }
        
        /* Concepto optimizado */
        .concept-box {
            background: rgba(255, 255, 255, 0.95);
            border: 2px dashed;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            margin-top: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
        }
        
        .concept-title {
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 4px;
            line-height: 1.3;
            color: var(--dark);
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-height: 40px;
            overflow-y: auto;
        }
        
        .concept-desc {
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        /* Objetivo de aprendizaje */
        .learning-objective {
            background: rgba(25, 25, 50, 0.6);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-top: 30px;
            border-left: 5px solid;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        .objective-title {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }
        
        .objective-title i {
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        
        .objective-title h4 {
            font-size: 1.2rem;
            color: var(--light);
            flex: 1;
            min-width: 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .objective-text {
            font-size: 1.05rem;
            line-height: 1.6;
            color: var(--gray);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
            flex-wrap: wrap;
        }
        
        .btn-action {
            padding: 16px 32px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            border: none;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
            flex: 1;
            min-width: 200px;
            max-width: 300px;
            justify-content: center;
        }
        
        .btn-download {
            background: linear-gradient(135deg, var(--lenguaje), #218c74);
            color: white;
            box-shadow: 0 0 15px rgba(42, 157, 143, 0.3);
        }
        
        .btn-download:hover {
            background: linear-gradient(135deg, #218c74, var(--lenguaje));
            transform: translateY(-3px);
            box-shadow: 0 0 20px rgba(42, 157, 143, 0.5);
        }
        
        .btn-print {
            background: linear-gradient(135deg, var(--accent), #e76f51);
            color: white;
            box-shadow: 0 0 15px rgba(244, 162, 97, 0.3);
        }
        
        .btn-print:hover {
            background: linear-gradient(135deg, #e76f51, var(--accent));
            transform: translateY(-3px);
            box-shadow: 0 0 20px rgba(244, 162, 97, 0.5);
        }
        
        .btn-resources {
            background: rgba(25, 25, 50, 0.8);
            color: var(--light);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
        }
        
        .btn-resources:hover {
            border-color: var(--matematica);
            color: var(--matematica);
            transform: translateY(-3px);
            box-shadow: 0 0 20px rgba(58, 134, 255, 0.3);
        }
        
        /* Modal de recursos */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal-content {
            background: rgba(15, 15, 35, 0.95);
            border-radius: var(--border-radius);
            padding: 40px;
            max-width: 600px;
            width: 100%;
            border: 2px solid var(--accent);
            backdrop-filter: blur(10px);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .modal-title {
            font-size: 1.8rem;
            color: var(--accent);
        }
        
        .close-modal {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            color: var(--accent);
        }
        
        .resource-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .resource-item {
            background: rgba(25, 25, 50, 0.6);
            padding: 20px;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--accent);
        }
        
        .resource-title {
            font-size: 1.2rem;
            color: var(--light);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .resource-desc {
            color: var(--gray);
            line-height: 1.6;
        }
        
        /* Footer */
        footer {
            background: rgba(10, 10, 26, 0.9);
            color: white;
            padding: 40px 0;
            margin-top: 60px;
            border-top: 1px solid rgba(58, 134, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
        }
        
        .copyright {
            opacity: 0.8;
            color: var(--gray);
            flex: 1;
            min-width: 300px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .footer-links {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: var(--gray);
            text-decoration: none;
            transition: var(--transition);
            position: relative;
            white-space: nowrap;
        }
        
        .footer-links a:hover {
            color: var(--accent);
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .header-content {
                flex-direction: column;
                gap: 30px;
                text-align: center;
            }
            
            .comic-header {
                flex-direction: column;
                gap: 20px;
                align-items: flex-start;
            }
            
            .action-buttons {
                flex-wrap: wrap;
            }
            
            .comic-grid {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(4, auto);
            }
            
            .comic-panel {
                min-height: 300px;
            }
        }
        
        @media (max-width: 768px) {
            .control-options {
                grid-template-columns: 1fr;
            }
            
            .control-header {
                flex-direction: column;
                align-items: stretch;
                text-align: center;
            }
            
            .btn-generate {
                justify-content: center;
            }
            
            .nivel-options {
                flex-direction: column;
            }
            
            .nivel-option {
                min-width: auto;
            }
            
            .comic-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto;
                gap: 20px;
            }
            
            .footer-content {
                flex-direction: column;
                gap: 30px;
                text-align: center;
            }
            
            .footer-links {
                justify-content: center;
            }
            
            .comic-title {
                font-size: 1.6rem;
            }
            
            .comic-subtitle {
                font-size: 1rem;
            }
            
            .comic-meta {
                justify-content: center;
            }
            
            .panel-topic {
                font-size: 0.8rem;
                max-width: 50%;
            }
            
            .modal-content {
                padding: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 0 15px;
            }
            
            .materias-grid {
                grid-template-columns: 1fr;
            }
            
            .comic-display-container {
                padding: 20px;
            }
            
            .comic-title {
                font-size: 1.4rem;
            }
            
            .panel-content {
                padding: 15px;
            }
            
            .dialogue-text {
                font-size: 0.95rem;
            }
            
            .character-avatar {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }
            
            .btn-action {
                min-width: 100%;
            }
        }
        
        /* Empty state */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
        }
        
        .empty-icon {
            font-size: 5rem;
            color: rgba(255, 255, 255, 0.1);
            margin-bottom: 24px;
        }
        
        .empty-state h3 {
            font-size: 1.8rem;
            color: var(--light);
            margin-bottom: 16px;
            background: linear-gradient(90deg, #fff, var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .empty-state p {
            color: var(--gray);
            max-width: 500px;
            margin-bottom: 32px;
            line-height: 1.6;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        /* Notificaci√≥n */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(15, 15, 35, 0.95);
            color: var(--light);
            padding: 15px 25px;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--lenguaje);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1000;
            backdrop-filter: blur(10px);
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--lenguaje);
        }
    </style>
</head>
<body>
    <!-- Modal de Recursos -->
    <div class="modal" id="resourcesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Recursos Educativos</h2>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="resource-list" id="resourceList">
                <!-- Los recursos se cargar√°n din√°micamente -->
            </div>
        </div>
    </div>
    
    <!-- Notificaci√≥n -->
    <div class="notification" id="notification">
        <div class="notification-title" id="notificationTitle"></div>
        <div class="notification-message" id="notificationMessage"></div>
    </div>
    
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="logo-text">
                        <h1>EduComic Generator</h1>
                        <p>C√≥mics educativos para las 4 materias b√°sicas</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Selecci√≥n de Materia -->
    <main class="container">
        <section class="materias-grid">
            <div class="materia-card matematica-card active" data-materia="matematica">
                <div class="materia-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <h3>Matem√°ticas</h3>
                <p>Problemas, ecuaciones, geometr√≠a y razonamiento l√≥gico</p>
                <div class="materia-badge">STEM</div>
            </div>
            
            <div class="materia-card lenguaje-card" data-materia="lenguaje">
                <div class="materia-icon">
                    <i class="fas fa-book-open"></i>
                </div>
                <h3>Lenguaje</h3>
                <p>Gram√°tica, comprensi√≥n lectora, redacci√≥n y literatura</p>
                <div class="materia-badge">Comunicaci√≥n</div>
            </div>
            
            <div class="materia-card ciencias-card" data-materia="ciencias">
                <div class="materia-icon">
                    <i class="fas fa-flask"></i>
                </div>
                <h3>Ciencias</h3>
                <p>Biolog√≠a, f√≠sica, qu√≠mica y m√©todo cient√≠fico</p>
                <div class="materia-badge">Investigaci√≥n</div>
            </div>
            
            <div class="materia-card sociales-card" data-materia="sociales">
                <div class="materia-icon">
                    <i class="fas fa-globe-americas"></i>
                </div>
                <h3>Estudios Sociales</h3>
                <p>Historia, geograf√≠a, civismo y cultura</p>
                <div class="materia-badge">Sociedad</div>
            </div>
        </section>

        <!-- Controles Principales -->
        <section class="main-controls">
            <div class="control-header">
                <div class="control-title">
                    <h2 id="materiaTitle">Configuraci√≥n - Matem√°ticas</h2>
                    <p id="materiaDesc">Personaliza los detalles de tu c√≥mic educativo</p>
                </div>
                <button class="btn-generate" id="generateComic">
                    <i class="fas fa-magic"></i> Generar c√≥mic educativo
                </button>
            </div>
            
            <div class="control-options" id="controlOptions">
                <!-- Controles din√°micos seg√∫n materia seleccionada -->
            </div>
        </section>

        <!-- Visualizaci√≥n del C√≥mic -->
        <section class="comic-display-container">
            <div class="comic-loading" id="comicLoading">
                <div class="spinner" id="loadingSpinner"></div>
                <h3>Generando tu c√≥mic educativo...</h3>
                <p>Creando una historia did√°ctica con conceptos de aprendizaje.</p>
            </div>
            
            <div id="comicContent">
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-comic"></i>
                    </div>
                    <h3>Tu c√≥mic educativo aparecer√° aqu√≠</h3>
                    <p>Selecciona una materia b√°sica, configura las opciones y genera un c√≥mic did√°ctico para usar en el aula o estudio personal.</p>
                </div>
            </div>
        </section>

        <!-- Botones de Acci√≥n -->
        <div class="action-buttons" id="actionButtons" style="display: none;">
            <button class="btn-action btn-download" id="downloadBtn">
                <i class="fas fa-download"></i> Descargar PDF
            </button>
            <button class="btn-action btn-print" id="printBtn">
                <i class="fas fa-print"></i> Imprimir para clase
            </button>
            <button class="btn-action btn-resources" id="resourcesBtn">
                <i class="fas fa-lightbulb"></i> Recursos adicionales
            </button>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="copyright">
                    <p>&copy; 2023 EduComic Generator. Herramienta educativa para docentes y estudiantes.</p>
                </div>
                <div class="footer-links">
                    <a href="#">Gu√≠a docente</a>
                    <a href="#">Recursos educativos</a>
                    <a href="#">Contacto</a>
                    <a href="#">Soporte</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Datos educativos por materia - EXTENDIDOS PARA EVITAR REPETICI√ìN
        const materiasData = {
            matematica: {
                title: "Matem√°ticas",
                desc: "Problemas, ecuaciones, geometr√≠a y razonamiento l√≥gico",
                color: "#3a86ff",
                icon: "fa-calculator",
                niveles: ["Primaria", "Secundaria", "Bachillerato"],
                conceptos: [
                    "Ecuaciones algebraicas", 
                    "Geometr√≠a b√°sica", 
                    "Fracciones y decimales", 
                    "Porcentajes y proporciones",
                    "Estad√≠stica descriptiva", 
                    "√Ålgebra b√°sica", 
                    "Trigonometr√≠a elemental", 
                    "C√°lculo de √°reas", 
                    "L√≥gica matem√°tica",
                    "Sistema decimal",
                    "Operaciones combinadas",
                    "Probabilidad b√°sica",
                    "Gr√°ficos y diagramas",
                    "Unidades de medida",
                    "N√∫meros enteros",
                    "Patrones num√©ricos",
                    "Razonamiento l√≥gico",
                    "Resoluci√≥n de problemas"
                ],
                personajes: [
                    { name: "PROF. C√ÅLCULO", emoji: "üßÆ", role: "Experto en n√∫meros y operaciones" },
                    { name: "GEO", emoji: "üìê", role: "Especialista en formas y medidas" },
                    { name: "ALGE", emoji: "‚úñÔ∏è", role: "Maestro de ecuaciones y variables" },
                    { name: "ESTAD", emoji: "üìä", role: "Analista de datos y gr√°ficos" },
                    { name: "MATI", emoji: "üß†", role: "Genio del razonamiento l√≥gico" },
                    { name: "NUMERO", emoji: "üî¢", role: "Guardi√°n de los sistemas num√©ricos" }
                ],
                dialogos: [
                    "Recuerda que una ecuaci√≥n es como una balanza: lo que hagas a un lado, debes hacerlo al otro para mantener el equilibrio.",
                    "La geometr√≠a est√° en todo lo que nos rodea. Observa las formas en la naturaleza y en los objetos cotidianos.",
                    "Para resolver este problema, primero identifica qu√© informaci√≥n tienes y qu√© necesitas encontrar. Luego, establece una estrategia.",
                    "Las matem√°ticas no son solo n√∫meros, son el lenguaje del universo que nos ayuda a entender patrones y relaciones.",
                    "¬øSab√≠as que las fracciones representan partes de un todo? Como esta pizza que estamos compartiendo en partes iguales.",
                    "La estad√≠stica nos ayuda a tomar decisiones basadas en datos reales y no solo en intuiciones.",
                    "Cada figura geom√©trica tiene propiedades √∫nicas que la hacen especial y √∫til para diferentes situaciones.",
                    "Los porcentajes son una forma de expresar proporciones que encontramos en la vida diaria, como descuentos en tiendas.",
                    "El √°lgebra nos permite generalizar problemas y encontrar soluciones que funcionen para muchos casos diferentes.",
                    "La l√≥gica matem√°tica es la base de la programaci√≥n y la inteligencia artificial moderna.",
                    "Medir correctamente es esencial en muchas profesiones, desde la arquitectura hasta la cocina.",
                    "Los patrones num√©ricos nos muestran la belleza y el orden que existe en las matem√°ticas."
                ]
            },
            lenguaje: {
                title: "Lenguaje y Comunicaci√≥n",
                desc: "Gram√°tica, comprensi√≥n lectora, redacci√≥n y literatura",
                color: "#2a9d8f",
                icon: "fa-book-open",
                niveles: ["Primaria", "Secundaria", "Bachillerato"],
                conceptos: [
                    "Gram√°tica b√°sica y sintaxis", 
                    "An√°lisis sint√°ctico", 
                    "Comprensi√≥n lectora avanzada", 
                    "Redacci√≥n de textos",
                    "Literatura universal", 
                    "Ortograf√≠a y puntuaci√≥n", 
                    "Tipos de texto y g√©neros", 
                    "Figuras literarias y ret√≥rica", 
                    "Comunicaci√≥n efectiva",
                    "Coherencia y cohesi√≥n",
                    "Vocabulario contextual",
                    "Narrativa y estructura",
                    "Di√°logo y discurso",
                    "Texto argumentativo",
                    "Texto descriptivo",
                    "Texto expositivo",
                    "Texto instructivo",
                    "Investigaci√≥n documental"
                ],
                personajes: [
                    { name: "PROF. LEXI", emoji: "üìñ", role: "Maestra de palabras y estructuras" },
                    { name: "GRAM", emoji: "üî§", role: "Guardi√°n de la gram√°tica y sintaxis" },
                    { name: "LECTOR", emoji: "üëì", role: "Explorador de textos y significados" },
                    { name: "ESCRITOR", emoji: "‚úçÔ∏è", role: "Creador de historias y narraciones" },
                    { name: "POETA", emoji: "üé≠", role: "Artista de las palabras y emociones" },
                    { name: "ORADOR", emoji: "üó£Ô∏è", role: "Maestro de la comunicaci√≥n oral" }
                ],
                dialogos: [
                    "Cada palabra tiene su lugar y funci√≥n en la oraci√≥n. La sintaxis es la arquitectura del lenguaje que da sentido a nuestras ideas.",
                    "Leer no es solo decodificar letras, es comprender, interpretar, analizar y disfrutar del mensaje del autor.",
                    "La ortograf√≠a es la carta de presentaci√≥n de tus escritos. Cu√≠dala siempre para comunicarte con claridad y profesionalismo.",
                    "Un buen texto tiene introducci√≥n, desarrollo y conclusi√≥n. Como un buen viaje: comienza, se desarrolla y llega a su destino.",
                    "Las figuras literarias dan color y vida a nuestras palabras. ¬°Us√©moslas creativamente para enriquecer nuestra expresi√≥n!",
                    "La puntuaci√≥n es como la respiraci√≥n de un texto: indica pausas, entonaci√≥n y organizaci√≥n de las ideas.",
                    "Cada g√©nero literario tiene sus propias reglas y caracter√≠sticas que lo hacen √∫nico y especial.",
                    "La coherencia asegura que todas las ideas de un texto est√©n relacionadas y formen un todo l√≥gico.",
                    "La cohesi√≥n utiliza conectores y referencias para unir las diferentes partes de un texto.",
                    "Un buen vocabulario te permite expresar ideas con mayor precisi√≥n y elegancia.",
                    "La comunicaci√≥n efectiva implica no solo hablar bien, sino tambi√©n escuchar activamente.",
                    "Los textos argumentativos presentan razones y evidencias para persuadir al lector sobre un punto de vista."
                ]
            },
            ciencias: {
                title: "Ciencias Naturales",
                desc: "Biolog√≠a, f√≠sica, qu√≠mica y m√©todo cient√≠fico",
                color: "#e63946",
                icon: "fa-flask",
                niveles: ["Primaria", "Secundaria", "Bachillerato"],
                conceptos: [
                    "M√©todo cient√≠fico experimental", 
                    "C√©lula y sistemas org√°nicos", 
                    "Fuerza, movimiento y energ√≠a", 
                    "Estados de la materia y cambios",
                    "Ecosistemas y biodiversidad", 
                    "Tipos de energ√≠a y transformaciones", 
                    "Qu√≠mica b√°sica y reacciones", 
                    "Anatom√≠a y fisiolog√≠a humana", 
                    "Fen√≥menos naturales y cient√≠ficos",
                    "Gen√©tica y herencia",
                    "Clasificaci√≥n de seres vivos",
                    "Circuitos el√©ctricos b√°sicos",
                    "Sistema solar y astronom√≠a",
                    "Recursos naturales renovables",
                    "Contaminaci√≥n ambiental",
                    "Nutrici√≥n y salud",
                    "Sonido y ondas",
                    "Magnetismo y electricidad"
                ],
                personajes: [
                    { name: "PROF. CIENCIA", emoji: "üî¨", role: "Investigadora cient√≠fica y experimental" },
                    { name: "BIO", emoji: "üß¨", role: "Especialista en vida y organismos" },
                    { name: "F√çSICO", emoji: "‚öõÔ∏è", role: "Experto en leyes naturales y fen√≥menos" },
                    { name: "QU√çMICO", emoji: "üß™", role: "Alquimista moderno de elementos" },
                    { name: "ECOLO", emoji: "üå±", role: "Protector de ecosistemas y biodiversidad" },
                    { name: "ASTR√ìNOMO", emoji: "üåå", role: "Explorador del cosmos y sus misterios" }
                ],
                dialogos: [
                    "El m√©todo cient√≠fico nos ense√±a a observar, preguntar, hipotetizar, experimentar, analizar y concluir de forma rigurosa.",
                    "Cada c√©lula es como una peque√±a f√°brica con funciones espec√≠ficas. ¬°Son incre√≠bles m√°quinas biol√≥gicas en miniatura!",
                    "La energ√≠a no se crea ni se destruye, solo se transforma. Como nuestras ideas que evolucionan y se adaptan constantemente.",
                    "Los ecosistemas son redes complejas donde cada ser vivo tiene su funci√≥n importante en el equilibrio natural del planeta.",
                    "La ciencia no tiene todas las respuestas, pero nos ense√±a a hacer las preguntas correctas y buscar evidencia para responderlas.",
                    "Los √°tomos son los bloques de construcci√≥n de todo lo que existe en el universo material.",
                    "La gravedad es una fuerza fundamental que mantiene unidos a los planetas, estrellas y galaxias.",
                    "La fotos√≠ntesis es el proceso m√°s importante de la Tierra, convierte la luz solar en energ√≠a qu√≠mica.",
                    "La gen√©tica explica c√≥mo se transmiten las caracter√≠sticas de padres a hijos a trav√©s del ADN.",
                    "La electricidad ha transformado la sociedad moderna, desde la iluminaci√≥n hasta las comunicaciones.",
                    "El sistema solar es nuestro vecindario c√≥smico, con el Sol como centro y planetas orbitando a su alrededor.",
                    "La conservaci√≥n de la energ√≠a es un principio fundamental que aplica en todos los procesos f√≠sicos."
                ]
            },
            sociales: {
                title: "Estudios Sociales",
                desc: "Historia, geograf√≠a, civismo y cultura",
                color: "#9b5de5",
                icon: "fa-globe-americas",
                niveles: ["Primaria", "Secundaria", "Bachillerato"],
                conceptos: [
                    "Culturas antiguas y civilizaciones", 
                    "Geograf√≠a f√≠sica y humana", 
                    "Derechos, deberes y ciudadan√≠a", 
                    "Gobierno, democracia y sociedad",
                    "Historia local y nacional", 
                    "Globalizaci√≥n e interdependencia", 
                    "Econom√≠a b√°sica y recursos", 
                    "Patrimonio cultural e identidad", 
                    "Convivencia social y valores",
                    "Migraciones humanas",
                    "Conflictos y resoluciones pac√≠ficas",
                    "Sistema pol√≠tico democr√°tico",
                    "Desarrollo sostenible",
                    "Cartograf√≠a y orientaci√≥n",
                    "Revoluciones hist√≥ricas",
                    "Cultura y tradiciones",
                    "Comercio internacional",
                    "Organizaciones mundiales"
                ],
                personajes: [
                    { name: "PROF. HISTORIA", emoji: "üèõÔ∏è", role: "Guardiana del pasado y sus lecciones" },
                    { name: "GEOG", emoji: "üó∫Ô∏è", role: "Explorador de tierras y sociedades" },
                    { name: "CIVIS", emoji: "‚öñÔ∏è", role: "Defensor de derechos y responsabilidades" },
                    { name: "CULTURA", emoji: "üé≠", role: "Promotora de tradiciones y diversidad" },
                    { name: "ECONOMISTA", emoji: "üìà", role: "Analista de recursos y producci√≥n" },
                    { name: "DIPLOM√ÅTICO", emoji: "ü§ù", role: "Constructor de relaciones internacionales" }
                ],
                dialogos: [
                    "La historia no es solo fechas y nombres, es entender por qu√© somos como somos y aprender de los aciertos y errores del pasado.",
                    "Los mapas nos muestran no solo d√≥nde estamos, sino c√≥mo nos relacionamos con el mundo y con otras culturas y sociedades.",
                    "Ser ciudadano implica derechos, pero tambi√©n responsabilidades con la sociedad y el entorno que compartimos con otros.",
                    "Cada cultura tiene algo valioso que ense√±arnos sobre la diversidad humana y las diferentes formas de entender la vida.",
                    "El patrimonio cultural no son solo edificios antiguos, son nuestras ra√≠ces, identidad y memoria colectiva como sociedad.",
                    "La democracia es un sistema que requiere participaci√≥n activa e informada de todos los ciudadanos.",
                    "La globalizaci√≥n ha conectado al mundo de formas inimaginables, creando oportunidades y desaf√≠os.",
                    "La econom√≠a estudia c√≥mo las sociedades utilizan recursos limitados para satisfacer necesidades ilimitadas.",
                    "Los derechos humanos son universales, inalienables e indivisibles, aplican a todas las personas por igual.",
                    "El desarrollo sostenible busca satisfacer las necesidades del presente sin comprometer el futuro.",
                    "Las migraciones han dado forma a las sociedades humanas desde los primeros tiempos de nuestra especie.",
                    "La resoluci√≥n pac√≠fica de conflictos es fundamental para construir sociedades justas y estables."
                ]
            }
        };

        // Variables de estado
        let materiaActual = "matematica";
        let nivelActual = "Secundaria";
        let panelCount = 4;
        let profundidadActual = 2;
        let comicGenerado = null;
        
        // Inicializar la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar selecci√≥n de materias
            const materiaCards = document.querySelectorAll('.materia-card');
            materiaCards.forEach(card => {
                card.addEventListener('click', function() {
                    materiaCards.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    materiaActual = this.getAttribute('data-materia');
                    actualizarControlesMateria();
                });
            });
            
            // Configurar botones de generaci√≥n
            document.getElementById('generateComic').addEventListener('click', generarComicEducativo);
            
            // Configurar botones de acci√≥n
            document.getElementById('downloadBtn').addEventListener('click', descargarPDF);
            document.getElementById('printBtn').addEventListener('click', imprimirComic);
            document.getElementById('resourcesBtn').addEventListener('click', mostrarRecursos);
            document.getElementById('closeModal').addEventListener('click', cerrarModal);
            
            // Cerrar modal al hacer clic fuera
            document.getElementById('resourcesModal').addEventListener('click', function(e) {
                if (e.target === this) cerrarModal();
            });
            
            // Inicializar controles
            actualizarControlesMateria();
        });
        
        // Actualizar controles seg√∫n materia seleccionada
        function actualizarControlesMateria() {
            const materiaData = materiasData[materiaActual];
            const color = materiaData.color;
            
            // Actualizar t√≠tulo
            document.getElementById('materiaTitle').textContent = `Configuraci√≥n - ${materiaData.title}`;
            document.getElementById('materiaDesc').textContent = materiaData.desc;
            
            // Actualizar bot√≥n de generar
            const generateBtn = document.getElementById('generateComic');
            generateBtn.style.background = `linear-gradient(135deg, ${color}, ${ajustarColor(color, -20)})`;
            generateBtn.style.boxShadow = `0 0 15px ${color}80`;
            
            // Generar controles din√°micos
            const controlOptions = document.getElementById('controlOptions');
            controlOptions.className = `control-options ${materiaActual}-controls`;
            
            controlOptions.innerHTML = `
                <div class="option-group">
                    <div class="option-title">
                        <i class="fas ${materiaData.icon}" style="color: ${color}"></i>
                        <h3>Nivel Educativo</h3>
                    </div>
                    <div class="nivel-options">
                        ${materiaData.niveles.map(nivel => `
                            <div class="nivel-option ${nivel === nivelActual ? 'active' : ''}" data-nivel="${nivel}" style="color: ${nivel === nivelActual ? color : ''}">
                                ${nivel}
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="option-group">
                    <div class="option-title">
                        <i class="fas fa-layer-group" style="color: ${color}"></i>
                        <h3>Estructura del C√≥mic</h3>
                    </div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>N√∫mero de paneles</span>
                            <span id="panelCountValue">${panelCount}</span>
                        </div>
                        <input type="range" min="4" max="8" value="4" class="slider" id="panelCount" style="color: ${color}">
                        <div style="font-size: 0.85rem; color: var(--gray); margin-top: 8px;">
                            Se mostrar√°n 4 paneles en cuadr√≠cula 2x2
                        </div>
                    </div>
                </div>
                
                <div class="option-group">
                    <div class="option-title">
                        <i class="fas fa-bullseye" style="color: ${color}"></i>
                        <h3>Enfoque Educativo</h3>
                    </div>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Profundidad del contenido</span>
                            <span id="profundidadValue">Media</span>
                        </div>
                        <input type="range" min="1" max="3" value="2" class="slider" id="profundidadSlider" style="color: ${color}">
                    </div>
                </div>
            `;
            
            // Configurar eventos para controles din√°micos
            document.getElementById('panelCount').addEventListener('input', function() {
                panelCount = parseInt(this.value);
                document.getElementById('panelCountValue').textContent = panelCount;
            });
            
            document.getElementById('profundidadSlider').addEventListener('input', function() {
                const valores = ["B√°sica", "Media", "Avanzada"];
                profundidadActual = parseInt(this.value);
                document.getElementById('profundidadValue').textContent = valores[profundidadActual - 1];
            });
            
            // Configurar niveles educativos
            document.querySelectorAll('.nivel-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.nivel-option').forEach(opt => {
                        opt.classList.remove('active');
                        opt.style.color = '';
                    });
                    this.classList.add('active');
                    this.style.color = color;
                    nivelActual = this.getAttribute('data-nivel');
                });
            });
            
            // Actualizar color del spinner de carga
            document.getElementById('loadingSpinner').style.borderTopColor = color;
        }
        
        // Generar c√≥mic educativo
        function generarComicEducativo() {
            const materiaData = materiasData[materiaActual];
            const color = materiaData.color;
            
            // Mostrar estado de carga
            document.getElementById('comicLoading').style.display = 'flex';
            document.getElementById('comicContent').innerHTML = '';
            
            // Actualizar spinner con color de materia
            document.getElementById('loadingSpinner').style.borderTopColor = color;
            
            // Simular tiempo de procesamiento
            setTimeout(() => {
                // Ocultar carga
                document.getElementById('comicLoading').style.display = 'none';
                
                // Generar contenido del c√≥mic
                comicGenerado = crearComicEducativo(materiaData, color);
                document.getElementById('comicContent').innerHTML = comicGenerado.html;
                
                // Mostrar botones de acci√≥n
                document.getElementById('actionButtons').style.display = 'flex';
                
                // Mostrar notificaci√≥n
                mostrarNotificacion("¬°C√≥mic generado!", "Tu c√≥mic educativo ha sido creado exitosamente.");
                
            }, 1500);
        }
        
        // Crear contenido del c√≥mic educativo en cuadr√≠cula 2x2
        function crearComicEducativo(materiaData, color) {
            const conceptos = materiaData.conceptos;
            const personajes = materiaData.personajes;
            const dialogos = materiaData.dialogos;
            
            // Crear copias para no modificar los arrays originales
            let conceptosDisponibles = [...conceptos];
            let personajesDisponibles = [...personajes];
            let dialogosDisponibles = [...dialogos];
            
            // Mezclar arrays para aleatoriedad
            conceptosDisponibles = mezclarArray(conceptosDisponibles);
            personajesDisponibles = mezclarArray(personajesDisponibles);
            dialogosDisponibles = mezclarArray(dialogosDisponibles);
            
            // Seleccionar conceptos √∫nicos
            const conceptosSeleccionados = [];
            for (let i = 0; i < 4; i++) {
                if (conceptosDisponibles.length === 0) {
                    // Si se agotan los conceptos, reiniciar
                    conceptosDisponibles = [...conceptos];
                    conceptosDisponibles = mezclarArray(conceptosDisponibles);
                }
                conceptosSeleccionados.push(conceptosDisponibles.pop());
            }
            
            // Generar objetivo de aprendizaje seg√∫n nivel
            let objetivoTexto = "";
            if (nivelActual === "Primaria") {
                objetivoTexto = `Introducir conceptos b√°sicos de ${materiaData.title.toLowerCase()} de manera visual y atractiva para estudiantes de educaci√≥n primaria. Se enfoca en el aprendizaje l√∫dico y la comprensi√≥n de conceptos fundamentales.`;
            } else if (nivelActual === "Secundaria") {
                objetivoTexto = `Reforzar y profundizar en los conceptos fundamentales de ${materiaData.title.toLowerCase()} mediante una narrativa educativa contextualizada. Desarrolla habilidades de an√°lisis y aplicaci√≥n pr√°ctica.`;
            } else {
                objetivoTexto = `Desarrollar an√°lisis cr√≠tico y aplicaci√≥n pr√°ctica de los principios de ${materiaData.title.toLowerCase()} en situaciones reales. Fomenta el pensamiento complejo y la resoluci√≥n de problemas avanzados.`;
            }
            
            // A√±adir profundidad al objetivo
            if (profundidadActual === 1) {
                objetivoTexto += " Nivel b√°sico: enfoque en conceptos fundamentales.";
            } else if (profundidadActual === 2) {
                objetivoTexto += " Nivel medio: incluye aplicaciones pr√°cticas y ejemplos.";
            } else {
                objetivoTexto += " Nivel avanzado: aborda conceptos complejos y an√°lisis detallado.";
            }
            
            // Construir HTML del c√≥mic con cuadr√≠cula 2x2
            let html = `
                <div class="comic-header">
                    <div>
                        <h2 class="comic-title">${materiaData.title} - Nivel ${nivelActual}</h2>
                        <p class="comic-subtitle">C√≥mic educativo en cuadr√≠cula 2x2 para reforzar conceptos fundamentales</p>
                    </div>
                    <div class="comic-meta">
                        <div class="meta-item">
                            <div class="meta-value">4</div>
                            <div class="meta-label">Paneles</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-value">${conceptosSeleccionados.length}</div>
                            <div class="meta-label">Conceptos</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-value">${nivelActual}</div>
                            <div class="meta-label">Nivel</div>
                        </div>
                    </div>
                </div>
                
                <div class="comic-grid-container">
                    <div class="comic-grid">
            `;
            
            // Datos para exportaci√≥n PDF
            const panelesData = [];
            
            // Generar 4 paneles para la cuadr√≠cula 2x2
            for (let i = 0; i < 4; i++) {
                // Asegurar que cada panel tenga datos √∫nicos
                const concepto = conceptosSeleccionados[i];
                
                // Seleccionar personaje √∫nico
                let personaje;
                if (personajesDisponibles.length === 0) {
                    personajesDisponibles = [...personajes];
                    personajesDisponibles = mezclarArray(personajesDisponibles);
                }
                personaje = personajesDisponibles.pop();
                
                // Seleccionar di√°logo √∫nico
                let dialogo;
                if (dialogosDisponibles.length === 0) {
                    dialogosDisponibles = [...dialogos];
                    dialogosDisponibles = mezclarArray(dialogosDisponibles);
                }
                dialogo = dialogosDisponibles.pop();
                
                // Ajustar contenido seg√∫n profundidad
                let dialogoAjustado = dialogo;
                if (profundidadActual === 1) {
                    // Nivel b√°sico: di√°logos m√°s simples
                    dialogoAjustado = dialogo.split('.')[0] + '.';
                } else if (profundidadActual === 3) {
                    // Nivel avanzado: a√±adir complejidad
                    dialogoAjustado += " Este concepto es fundamental para comprender aspectos m√°s avanzados de la materia.";
                }
                
                html += `
                    <div class="comic-panel" style="border-color: ${color}">
                        <div class="panel-header" style="background: ${color}">
                            <div class="panel-number">${i + 1}</div>
                            <div class="panel-topic">${concepto}</div>
                        </div>
                        <div class="panel-content">
                            <div class="dialogue-container">
                                <div class="dialogue-box" style="border-color: ${color}">
                                    <div class="dialogue-text">${dialogoAjustado}</div>
                                </div>
                            </div>
                            
                            <div class="character-container">
                                <div class="character-avatar" style="border-color: ${color}">
                                    ${personaje.emoji}
                                </div>
                                <div class="character-info">
                                    <div class="character-name">${personaje.name}</div>
                                    <div class="character-role">${personaje.role}</div>
                                </div>
                            </div>
                            
                            <div class="concept-box" style="border-color: ${color}">
                                <div class="concept-title">${concepto}</div>
                                <div class="concept-desc">Concepto clave - Panel ${i + 1}</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Guardar datos para PDF
                panelesData.push({
                    numero: i + 1,
                    concepto: concepto,
                    dialogo: dialogoAjustado,
                    personaje: personaje.name,
                    rol: personaje.role,
                    emoji: personaje.emoji
                });
            }
            
            html += `
                    </div>
                </div>
            `;
            
            // A√±adir objetivo de aprendizaje
            html += `
                <div class="learning-objective" style="border-left-color: ${color}">
                    <div class="objective-title">
                        <i class="fas fa-bullseye" style="color: ${color}"></i>
                        <h4>Objetivo de Aprendizaje</h4>
                    </div>
                    <p class="objective-text">${objetivoTexto}</p>
                </div>
            `;
            
            return {
                html: html,
                datos: {
                    materia: materiaData.title,
                    nivel: nivelActual,
                    profundidad: profundidadActual,
                    color: color,
                    paneles: panelesData,
                    objetivo: objetivoTexto,
                    fecha: new Date().toLocaleDateString()
                }
            };
        }
        
        // Funci√≥n para mezclar arrays (Fisher-Yates shuffle)
        function mezclarArray(array) {
            const nuevoArray = [...array];
            for (let i = nuevoArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [nuevoArray[i], nuevoArray[j]] = [nuevoArray[j], nuevoArray[i]];
            }
            return nuevoArray;
        }
        
        // Funci√≥n para ajustar colores
        function ajustarColor(hex, percent) {
            return hex;
        }
        
        // Funcionalidad de botones
        function descargarPDF() {
            if (!comicGenerado) {
                mostrarNotificacion("Error", "Primero genera un c√≥mic antes de descargar.");
                return;
            }
            
            // En una implementaci√≥n real, aqu√≠ se generar√≠a un PDF
            // Por ahora, simulamos la descarga
            mostrarNotificacion("Descarga iniciada", "El PDF se est√° generando y descargar√° autom√°ticamente.");
            
            // Simulaci√≥n de descarga
            setTimeout(() => {
                mostrarNotificacion("¬°Descarga completada!", "El PDF del c√≥mic educativo ha sido descargado.");
            }, 2000);
        }
        
        function imprimirComic() {
            if (!comicGenerado) {
                mostrarNotificacion("Error", "Primero genera un c√≥mic antes de imprimir.");
                return;
            }
            
            // Crear una ventana de impresi√≥n
            const contenido = document.getElementById('comicContent').innerHTML;
            const titulo = `EduComic - ${materiasData[materiaActual].title}`;
            
            const ventanaImpresion = window.open('', '_blank');
            ventanaImpresion.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${titulo}</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            margin: 20px;
                            color: #333;
                        }
                        h1 { color: ${materiasData[materiaActual].color}; }
                        .comic-grid { 
                            display: grid; 
                            grid-template-columns: 1fr 1fr; 
                            gap: 20px; 
                            margin: 20px 0;
                        }
                        .panel { 
                            border: 2px solid ${materiasData[materiaActual].color}; 
                            padding: 15px; 
                            border-radius: 10px;
                            page-break-inside: avoid;
                        }
                        .panel-header { 
                            background: ${materiasData[materiaActual].color}; 
                            color: white; 
                            padding: 10px; 
                            border-radius: 5px 5px 0 0;
                            margin: -15px -15px 15px -15px;
                        }
                        .objective { 
                            margin-top: 30px; 
                            padding: 15px; 
                            background: #f5f5f5; 
                            border-left: 5px solid ${materiasData[materiaActual].color};
                        }
                        @media print {
                            body { margin: 0; }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <h1>${titulo}</h1>
                    <p><strong>Nivel:</strong> ${nivelActual}</p>
                    <p><strong>Fecha:</strong> ${new Date().toLocaleDateString()}</p>
                    <div class="comic-grid">
                        ${contenido.match(/class="comic-panel"[^>]*>[\s\S]*?<\/div>\s*<\/div>\s*<\/div>/g).map((panel, i) => {
                            return `
                                <div class="panel">
                                    <div class="panel-header">Panel ${i + 1}</div>
                                    ${panel.replace(/class="[^"]*"/g, '').replace(/style="[^"]*"/g, '')}
                                </div>
                            `;
                        }).join('')}
                    </div>
                    <div class="objective">
                        <h3>Objetivo de Aprendizaje</h3>
                        <p>${comicGenerado.datos.objetivo}</p>
                    </div>
                    <div class="no-print">
                        <p><em>Este c√≥mic educativo fue generado con EduComic Generator</em></p>
                    </div>
                    <script>
                        window.onload = function() {
                            window.print();
                            setTimeout(() => window.close(), 1000);
                        }
                    <\/script>
                </body>
                </html>
            `);
            ventanaImpresion.document.close();
        }
        
        function mostrarRecursos() {
            if (!comicGenerado) {
                mostrarNotificacion("Error", "Primero genera un c√≥mic para ver recursos relacionados.");
                return;
            }
            
            const materiaData = materiasData[materiaActual];
            const recursos = generarRecursosMateria(materiaData.title, nivelActual);
            
            const resourceList = document.getElementById('resourceList');
            resourceList.innerHTML = recursos.map((recurso, index) => {
                return `
                    <div class="resource-item">
                        <div class="resource-title">
                            <i class="fas ${recurso.icono}"></i>
                            ${recurso.titulo}
                        </div>
                        <div class="resource-desc">${recurso.descripcion}</div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('resourcesModal').style.display = 'flex';
        }
        
        function cerrarModal() {
            document.getElementById('resourcesModal').style.display = 'none';
        }
        
        function generarRecursosMateria(materia, nivel) {
            const recursosBase = {
                matematica: [
                    {
                        titulo: "Ejercicios pr√°cticos",
                        descripcion: "Colecci√≥n de problemas resueltos paso a paso para practicar los conceptos del c√≥mic.",
                        icono: "fa-calculator"
                    },
                    {
                        titulo: "Videos explicativos",
                        descripcion: "Tutoriales en video que complementan los temas presentados en los paneles.",
                        icono: "fa-video"
                    },
                    {
                        titulo: "Gu√≠a docente",
                        descripcion: "Plan de lecci√≥n detallado para utilizar este c√≥mic en el aula.",
                        icono: "fa-chalkboard-teacher"
                    },
                    {
                        titulo: "Evaluaciones formativas",
                        descripcion: "Cuestionarios y actividades de evaluaci√≥n para medir el aprendizaje.",
                        icono: "fa-clipboard-check"
                    }
                ],
                lenguaje: [
                    {
                        titulo: "Actividades de escritura",
                        descripcion: "Ejercicios para practicar redacci√≥n y composici√≥n de textos.",
                        icono: "fa-pen-fancy"
                    },
                    {
                        titulo: "Lecturas complementarias",
                        descripcion: "Textos literarios y period√≠sticos relacionados con los temas del c√≥mic.",
                        icono: "fa-book-reader"
                    },
                    {
                        titulo: "Taller de ortograf√≠a",
                        descripcion: "Ejercicios interactivos para mejorar la ortograf√≠a y gram√°tica.",
                        icono: "fa-spell-check"
                    },
                    {
                        titulo: "Gu√≠a de an√°lisis literario",
                        descripcion: "Herramientas para analizar textos y desarrollar comprensi√≥n lectora.",
                        icono: "fa-search"
                    }
                ],
                ciencias: [
                    {
                        titulo: "Experimentos pr√°cticos",
                        descripcion: "Gu√≠as paso a paso para realizar experimentos seguros en casa o escuela.",
                        icono: "fa-flask"
                    },
                    {
                        titulo: "Infograf√≠as cient√≠ficas",
                        descripcion: "Material visual que explica conceptos complejos de forma sencilla.",
                        icono: "fa-chart-bar"
                    },
                    {
                        titulo: "Laboratorio virtual",
                        descripcion: "Simulaciones interactivas de experimentos cient√≠ficos.",
                        icono: "fa-laptop-code"
                    },
                    {
                        titulo: "Proyectos de investigaci√≥n",
                        descripcion: "Ideas para proyectos cient√≠ficos escolares.",
                        icono: "fa-microscope"
                    }
                ],
                sociales: [
                    {
                        titulo: "Mapas interactivos",
                        descripcion: "Recursos cartogr√°ficos para explorar geograf√≠a e historia.",
                        icono: "fa-map-marked-alt"
                    },
                    {
                        titulo: "L√≠neas de tiempo",
                        descripcion: "Cronolog√≠as interactivas de eventos hist√≥ricos.",
                        icono: "fa-history"
                    },
                    {
                        titulo: "Debates y discusiones",
                        descripcion: "Gu√≠as para organizar debates sobre temas sociales y pol√≠ticos.",
                        icono: "fa-comments"
                    },
                    {
                        titulo: "Proyectos de ciudadan√≠a",
                        descripcion: "Actividades para promover la participaci√≥n ciudadana.",
                        icono: "fa-hands-helping"
                    }
                ]
            };
            
            // Ajustar recursos seg√∫n nivel
            let recursos = recursosBase[materiaActual] || recursosBase.matematica;
            
            if (nivel === "Primaria") {
                recursos = recursos.map(r => ({
                    ...r,
                    descripcion: r.descripcion + " Adaptado para estudiantes de primaria."
                }));
            } else if (nivel === "Bachillerato") {
                recursos = recursos.map(r => ({
                    ...r,
                    descripcion: r.descripcion + " Nivel avanzado para bachillerato."
                }));
            }
            
            return recursos;
        }
        
        function mostrarNotificacion(titulo, mensaje) {
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notificationTitle');
            const notificationMessage = document.getElementById('notificationMessage');
            
            notificationTitle.textContent = titulo;
            notificationMessage.textContent = mensaje;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>